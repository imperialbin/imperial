// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// thanks prisma - devlooskie
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  package  = db
}

generator client {
  provider = "go run github.com/prisma/prisma-client-go"
}

model User {
  id                       String       @id @default(uuid())
  userId                   Int          @default(autoincrement())
  username                 String
  email                    String
  betaCode                 String
  banned                   Boolean      @default(false)
  confirmed                Boolean      @default(false)
  ip                       String
  codesLeft                Int
  icon                     String       @default("/assets/img/pfp.png")
  password                 String
  memberPlus               Boolean      @default(false)
  codes                    String[]
  documentsMade            Int
  activeUnlimitedDocuments Int
  discordId                String?
  githubAccess             String?
  opt                      String?
  settings                 UserSettings @relation(fields: [userSettingsId], references: [id])
  userSettingsId           String
}

model UserSettings {
  id            String  @id @default(uuid())
  clipboard     Boolean @default(false)
  longerUrls    Boolean @default(false)
  shorterUrls   Boolean @default(false)
  instantDelete Boolean @default(false)
  encrypted     Boolean @default(false)
  imageEmbed    Boolean @default(false)
  expiration    Int     @default(5)

  User User[]
  @@map("user_settings")
}

model Document {
  id                 String           @id @default(uuid())
  documentId         String
  content            String
  creator            String?
  creationDate       Int
  expirationDate     Int
  documentSettings   DocumentSettings @relation(fields: [documentSettingsId], references: [id])
  documentSettingsId String
  gist               String?
  views              Int
  encryptedIv        String?
}

model DocumentSettings {
  id            String   @id @default(uuid())
  language      String?
  imageEmbed    Boolean
  instantDelete Boolean
  encrypted     Boolean
  public        Boolean
  editors       String[]

  Document Document[]
  @@map("document_settings")
}
